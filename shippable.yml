language: java
jdk: openjdk9

branches:
  only:
    - master

env:
  global:
    - BALLERINA_VERSION=0.975.0
    - DISTRIBUTION_NAME=ballerina-platform-$BALLERINA_VERSION
    - DOCKER_REPO="btest"
    - DOCKER_ACC=pizak # replace with your Docker Hub account name    



build:


  ci:
    - pushd $HOME
    - wget https://product-dist.ballerina.io/downloads/$BALLERINA_VERSION/$DISTRIBUTION_NAME.zip
    - unzip $DISTRIBUTION_NAME.zip
    - export PATH=$PATH:$HOME/$DISTRIBUTION_NAME/bin
    - popd
    - ballerina version
    - ballerina build btest
    - ballerina test btest
    
  post_ci:
    - docker push pizak/btest:0.0.1
    


integrations:

  notifications:
    - integrationName: email
      type: email
      on_success: change
      on_failure: always
      on_pull_request: never



  hub:
    - integrationName: docker-registry 
      type: dockerRegistryLogin
